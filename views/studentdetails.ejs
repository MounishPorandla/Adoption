<%- include("header") -%>
<link rel="stylesheet" href="css/studentdetails.css">


<script type="text/javascript">
  function reveal() {
    var reveals = document.querySelectorAll(".reveal");

    for (var i = 0; i < reveals.length; i++) {
      var windowHeight = window.innerHeight;
      var elementTop = reveals[i].getBoundingClientRect().top;
      var elementVisible = 150;

      if (elementTop < windowHeight - elementVisible) {
        reveals[i].classList.add("active");
      } else {
        reveals[i].classList.remove("active");
      }
    }
  }

  window.addEventListener("scroll", reveal);


  $(function() {
    $('.repeat').click(function() {
      var classes = $(this).parent().attr('class');
      $(this).parent().attr('class', 'animate');
      var indicator = $(this);
      setTimeout(function() {
        $(indicator).parent().addClass(classes);
      }, 20);
    });
  });
</script>

</head>

<body>

  <nav class="navbar navbar-expand-lg navbar-dark bg-ligh">
    <a class="navbar-brand" href="/" style="border:0">Orphanage</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="btn btn-light logout  navbarbutton" href="/logout" role="button">Log Out</a>
    <div class="collapse navbar-collapse mr-right" id="navbarSupportedContent">
    </div>
  </nav>


  <%const array=[ ]%>
  <%const groupname=" "%>
  <%chat.forEach(function(chatitem){ %>
  <%items.forEach(function(item){ %>
  <%if(item.adminname=== check){ %>
  <%founduser.forEach(function(useritem){ %>
  <%if(array.includes(chatitem.sendername) === false && chatitem.sendername===useritem.name && item.name==chatitem.recevername){ %>
  <%array.push(chatitem.sendername)%>
  <%} %>
  <%}) %>
  <%} %>
  <%}) %>
  <%}) %>

  <%items.forEach(function(orphanitem){ %>
  <div class="chatbox">
    <%if(orphanitem.adminname=== check){ %>
    <h5>Chat With </h5>
    <% array.forEach(function(item){ %>
    <div class="chat">
      <h4 class="listItem"><%=item%></h4>
      <a class="chatatag" href="/chat/with/<%=item%>+<%=orphanitem.name%>">Chat</a>
    </div>
    <%}) %>
    <%} %>
  </div>
  <%}) %>

  <!-- ////////////////////////////////////////////////////////////////////// -->
  <%items.forEach(function(item){ %>
  <%if(check===item.adminname){%>
  <h3 class="name animate__animated animate__zoomInDown"> <%=item.name%></h3>
  <%}%>
  <%}) %>
  <hr class="titlebelow" style="height:1px;border-width:0;color:#897134;background-color:#897134;">
  <div class="top">
    <div class="row">
      <div class="col-md-6 orphanageimagebox ">
        <%items.forEach(function(item){ %>
        <%if(check===item.adminname){%>
        <img class="orphanageimage" src="data:image/<%=item.img.contentType%>;base64,
                                       <%=item.img.data.toString('base64')%>">
        <%}%>
      <%})%>
      </div>
      <div class="col-md-6 box">
        <%items.forEach(function(item){ %>
        <%if(check===item.adminname){%>
        <p>Orphanage address : <%=item.address%></p>
        <p>Phone number : <%=item.phonenum%></p>
        <p>State : <%=item.state%></p>
        <p>City : <%=item.city%></p>
        <p>Pincode : <%=item.pincode%></p>
        <p>Mail : <%=item.mail%></p>
        <%}%>
        <%})%>
      </div>
    </div>
  </div>

  <!-- ////////////////////////////////description/////////////////////////// -->
  <h3 class="Childrenhed animate__animated animate__zoomInDown">Description</h3>
  <div class="descriptionbox">
    <%items.forEach(function(item){ %>
    <%if(check===item.adminname){%>
    <p><%=item.description%></p>
    <%}%>
    <%})%>
  </div>



  <!-- //////////////////////////////////request//////////////////////////////// -->

  <div class="requests">
    <h3>requests</h3>
    <%items.forEach(function(mainitem){ %>
    <%requestsgot.forEach(function(request){ %>
    <%if(check===mainitem.adminname){%>
    <%if(request.orphanagename===mainitem.name){%>
    <div class="containerrev">
      <div class="container  d-flex align-items-center justify-content-center position-relative flex-wrap">
        <div class="card d-flex position-relative flex-column">
          <div class='imgContainer'>
            <h6><%=request.requestername%></h6>
            <p>requested for <%=request.childname%></p>
          </div>
          <div class="content">
            <form class="" action="/acceptorreject" method="post">
              <button type="submit" class="btn btn-success" name="button" value="<%=request._id%>@<%=request.orphanagename%>&<%=request.requestername%>+<%=request.childname%>*ok"><i class="fas fa-user-check"></i></button>
              <button type="submit" class="btn btn-danger" name="button" value="<%=request._id%>@<%=request.orphanagename%>&<%=request.requestername%>+<%=request.childname%>*notok"><i class="fas fa-times"></i></button>
            </form>
          </div>
        </div>
      </div>
    </div>

    <%}%>
    <%}%>
    <%})%>
    <%})%>
  </div>


  <!-- ////////////////////////////////children/////////////////////////// -->
  <h1 class="Childrenhed animate__animated animate__zoomInDown">Children</h1>
  <hr>
  <div class="container reveal scroll fade-left" style="width:90%px; height:90%px; border:0px; overflow-x:visible; overflow-y:hidden; white-space:nowrap;">
    <!-- various of text here that can makes it go out the border-->
    <%childitems.forEach(function(item){ %>
    <%items.forEach(function(mainitem){ %>
    <%if(check===mainitem.adminname){%>
    <%if(mainitem.name===item.orphanage){%>
    <!-- flip-card-container -->
    <div class="flip-card-container" style="--hue: 170">
      <div class="flip-card">
        <div class="card-front">
          <figure>
            <div class="img-bg"></div>
            <img src="images/cardbg.jpg" alt="Image 2">
            <figcaption><%=item.name%></figcaption>
          </figure>

          <ul>
            <p>Age : <%=item.age%></p>
            <p>Gender : <%=item.gender%></p>
            <p>Hobies : <%=item.hobies%></p>
            <p>Studies : <%=item.studies%></p>
            <p>Guardian : <%=item.guardian%></p>
            <p>Intrested In : <%=item.intrestedin%></p>
          </ul>
        </div>

        <div class="card-back">
          <figure>
            <div class="img-bg"></div>
            <img class="childimage" src="data:image/<%=item.img.contentType%>;base64,
                                                   <%=item.img.data.toString('base64')%>">
          </figure>

          <div class="design-container">
            <span class="design design--1"></span>
            <span class="design design--2"></span>
            <span class="design design--3"></span>
            <span class="design design--4"></span>
            <span class="design design--5"></span>
            <span class="design design--6"></span>
            <span class="design design--7"></span>
            <span class="design design--8"></span>
          </div>
        </div>
      </div>
    </div>
    <%}%>
            <%}%>
    <%}) %>
    <%})%>
  </div>





  <!-- ///////////////////////////////student add details/////////////////////////////////// -->
  <div class="btn11 botton" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
    <span>Add student details</span>
    <div class="transition"></div>
  </div>

  <div class="collapse" id="collapseExample">
    <div class="">
      <%items.forEach(function(item){ %>
      <%if(check===item.adminname){%>
      <div class="card adddetailsbox">
        <h1>Add Student Details</h1>
        <form action="/studentdetails" method="POST" enctype="multipart/form-data">
          <div class="form-row">
            <div class="form-group col-md-6">
              <label> Name</label>
              <input type="text" class="form-control" name="name" placeholder="Name" required>
            </div>
            <div class="form-group col-md-6">
              <label for="inputPassword4">Age</label>
              <input type="text" class="form-control" name="age" placeholder="ID">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label> Gender</label>
              <input type="text" class="form-control" name="gender" placeholder="Name" required>
            </div>
            <div class="form-group col-md-6">
              <label for="inputPassword4">Hobies</label>
              <input type="text" class="form-control" name="hobies" placeholder="ID">
            </div>
          </div>
          <div class="form-row">
            <div class="form-group col-md-6">
              <label> Intrested In</label>
              <input type="text" class="form-control" name="intrestedin" placeholder="Name">
            </div>
            <div class="form-group col-md-6">
              <label for="inputPassword4">studies</label>
              <input type="text" class="form-control" name="studies" placeholder="ID">
            </div>
          </div>
          <div class="form-group col-md-6">
            <label for="inputPassword4">guardian</label>
            <input type="text" class="form-control" name="guardian" placeholder="ID" required>
          </div>
          <div class="form-group col-md-6">
            <label for="inputPassword4">Date of Birth</label>
            <input type="date" class="form-control" name="dob" placeholder="DOB" required>
          </div>
          <input type="file" name="image" class="file" required>
          <button type="submit" class="btnfos btnfos-1" value="<%=item.name%>" name="button"> <svg>
              <rect x="0" y="0" fill="none" width="100%" height="100%" />
            </svg>Submit</button>
        </form>
      </div>
      <%}%>
        <%}) %>
    </div>
  </div>

  <%- include("footer") -%>
